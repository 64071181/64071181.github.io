<html><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>真小六壬占卜系統</title>
<style>
    body {
        font-family: 'Microsoft JhengHei', Arial, sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        background-color: #f0f0f0;
        padding: 20px;
    }
    .container {
        background-color: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
        max-width: 800px;
        width: 100%;
    }
    h1 {
        text-align: center;
        color: #333;
    }
    .input-group {
        margin-bottom: 10px;
    }
    .input-group2 {text-align: center;}
    .input-group label {
        display: inline-block;
        width: 100px;
    }
    .input-group input {
        width: calc(100% );
        padding: 5px;
    }
    .input-group2 input,.input-group2 label  {
        display: inline-block;
        width: calc((100%) / 3.3 );
        padding: 5px;
    }
    .grid {
        display: grid;
        grid-template-columns: repeat(3, 100px);
        gap: 10px;
        margin-top: 20px;
        justify-content: center;
    }
    .cell {
        width: 100px;
        height: 100px;
        border: 1px solid #000;
        display: grid;
        grid-template-columns: 1fr 1fr;
        grid-template-rows: 1fr 1fr;
        padding: 5px;
        box-sizing: border-box;
        font-size: 16px;
    }
    .cell div {
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .cell .number { justify-content: flex-start; }
    .cell .element { justify-content: flex-end; }
    .cell .direction { justify-content: flex-start; align-items: flex-end; }
    .cell .deity { justify-content: flex-end; align-items: flex-end; }
    button {
        display: block;
        width: 100%;
        margin-top: 20px;
        padding: 10px;
        background-color: #4CAF50;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
    }
    .result {
        margin-top: 20px;
        text-align: left;
    }
    .result .解1{
        width: calc(100% / 3 );
        float: left;
    }

    /* 分享功能 */
    .share-buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
    }
    .share-buttons button {
        width: 30%;
        font-size: 14px;
    }
    #shareToX {
        background-color: #1DA1F2;
    }
    #shareToWhatsapp {
        background-color: #25D366;
    }
    #copyContent {
        background-color: #6c757d;
    }

    /* 記錄功能 */
    .history {
        margin-top: 20px;
    }
    .history h2 {
        text-align: center;
    }
    #historyList {
        list-style-type: none;
        padding: 0;
    }
    #historyList li {
        background-color: #f9f9f9;
        border: 1px solid #ddd;
        margin-bottom: 10px;
        padding: 10px;
        position: relative;
    }
    #historyList li strong{font-size: 40px;font-style: italic;color: #05eeff;margin-right: 10px;}
    .deleteBtn {
        position: absolute;
        top: 0px;
        right: 10px;
        width: 100px;
        background-color: #ff4d4d;
        color: white;
        border: none;
        padding: 5px 10px;
        cursor: pointer;
    }

</style>
<script src="https://code.jquery.com/jquery-3.7.0.js"></script>
</head>
<body>
    <div class="container">
        <h1>真小六壬占卜系統</h1>
        <div class="input-group">
            <label for="question">占卜題目：</label>
            <input type="text" id="question" name="question">
        </div>

        <div class="input-group2">
            <label for="number1">第一個數字：</label>
            <label for="number2">第二個數字：</label>
            <label for="number3">第三個數字：</label>
            
        </div>
        <div class="input-group2">
            <input type="number" id="number1" name="number1" min="1">
            <input type="number" id="number2" name="number2" min="1">
            <input type="number" id="number3" name="number3" min="1">
        </div>
        
        <div class="grid">
            <div class="cell" id="cell2">
                <div class="number">2</div>
                <div class="element">木</div>
                <div class="direction">巽</div>
                <div class="deity">留連</div>
            </div>
            <div class="cell" id="cell3">
                <div class="number">3</div>
                <div class="element">火</div>
                <div class="direction">离</div>
                <div class="deity">速喜</div>
            </div>
            <div class="cell" id="cell7">
                <div class="number">7</div>
                <div class="element">土</div>
                <div class="direction">坤</div>
                <div class="deity">病符</div>
            </div>
            <div class="cell" id="cell1">
                <div class="number">1</div>
                <div class="element">木</div>
                <div class="direction">震</div>
                <div class="deity">大安</div>
            </div>
            <div class="cell" id="cell6">
                <div class="number">6</div>
                <div class="element">土</div>
                <div class="direction">中</div>
                <div class="deity">空亡</div>
            </div>
            <div class="cell" id="cell4">
                <div class="number">4</div>
                <div class="element">金</div>
                <div class="direction">兌</div>
                <div class="deity">赤口</div>
            </div>
            <div class="cell" id="cell8">
                <div class="number">8</div>
                <div class="element">土</div>
                <div class="direction">艮</div>
                <div class="deity">桃花</div>
            </div>
            <div class="cell" id="cell5">
                <div class="number">5</div>
                <div class="element">水</div>
                <div class="direction">坎</div>
                <div class="deity">小吉</div>
            </div>
            <div class="cell" id="cell9">
                <div class="number">9</div>
                <div class="element">金</div>
                <div class="direction">乾</div>
                <div class="deity">天德</div>
            </div>
        </div>

        <button id="divineBtn">占卜</button>
        
        <div class="result">
            <p id="resultNumbers"></p>
            <p id="resultElements"></p>
            <p id="resultDirections"></p>
            <p id="resultDeities"></p>
            <p id="resultExplanation"></p>
        </div>
        
        <div class="share-buttons">
            <button id="shareToX">分享到 X</button>
            <button id="shareToWhatsapp">分享到 WhatsApp</button>
            <button id="copyContent">複製內容</button>
        </div>

        <div class="history">
            <h2>占卜歷史記錄</h2>
            <ul id="historyList"></ul>
        </div>

    </div>

    <script>
        // 占卜資料
        const divinationData = {
            elements: ['木', '木', '火', '金', '水', '土', '土', '土', '金'],
            directions: [
                '震(正東)(突發機會、意外、大起大落、左臂 )',
                '巽（東南）(飄忽不定、沒主見、猶疑、變化中、不落實、徘徊、左肩)', 
                '离（正南）(不持久、短暫、引人注目、開局好、虎頭蛇尾、有始無終、表面文章、急進、大事難成、上胸 )', 
                '兌（正西）(心驚、口舌事非、會議、不會一次談成、爭吵、只說不做、不行動、有原則、有匡架、有缺陷)', 
                '坎（正北）(波折、變化、曲折、不穩定、勞心力、懮患意識強、不順、與閑集人有關、壞變好 、好變壞 )', 
                '中', 
                '坤（西南）(慢而穩、從小事成大事、平地聲雷、問題多、散亂、包括、厚度、平易近人、適合研究)', 
                '艮（東北）(止、慢、守、慢性子、守承諾、反應遲鈍、乳房、腳趾 )', 
                '乾（西北）(事情大、很重要、範圍廣、大人物、沒大財、目中無人、終點、左胸、左腿 )'
            ],
            deities: [
                '大安(長期、緩慢、穩定 ; 求穩吉、求變不吉)', 
                '留連(停止、反覆、複雜 ; 挽留吉)', 
                '速喜(驚喜、快速、突變 ; 意外好事)', 
                '赤口(爭鬥、凶惡、傷害、吵架、打架、訴訟、事非、肉體受傷 ; 最凶)', 
                '小吉(不多、尚可、成中有缺 ; 起步吉)', 
                '空亡(失去、虛偽、空想 ; 先得後失 ; 忌金錢事 ; 可多接觸玄學、哲學、心理學 ; 現實差、虛幻好)', 
                '病符(病態、異常、治療 ; 先病後治、過程痛苦)', 
                '桃花(欲望、牵绊、異性 ; 人際關係好、男女事好、其他都差)', 
                '天德(貴人、上司、老闆、高、遠 ; 求人吉、靠人吉)'
            ]
        };

        function calculatePosition(startPos, number) {
            return ((startPos + number - 1) % 9) || 9;
        }

        function getElementRelation(element1, element2) {
            const relations = {
                '木生火': ['木', '火'],
                '火生土': ['火', '土'],
                '土生金': ['土', '金'],
                '金生水': ['金', '水'],
                '水生木': ['水', '木'],
                '木洩水': ['木', '水'],
                '水洩金': ['水', '金'],
                '金洩土': ['金', '土'],
                '土洩火': ['土', '火'],
                '火洩木': ['火', '木'],
                '木克土': ['木', '土'],
                '土克水': ['土', '水'],
                '水克火': ['水', '火'],
                '火克金': ['火', '金'],
                '金克木': ['金', '木'],
                '木耗金': ['木', '金'],
                '金耗火': ['金', '火'],
                '火耗水': ['火', '水'],
                '水耗土': ['水', '土'],
                '土耗木': ['土', '木']
            };

            for (let [relation, elements] of Object.entries(relations)) {
                if (elements[0] === element1 && elements[1] === element2) {
                    return relation.charAt(1);  // 返回关系的最后两个字，如"生"、"洩"、"克"、"耗"
                }
            }
            return '同';
        }

        /* 占卜功能 */
        const 格行 = '<br>'
        function divine() {
            const number1 = parseInt(document.getElementById('number1').value);
            const number2 = parseInt(document.getElementById('number2').value);
            const number3 = parseInt(document.getElementById('number3').value);

            if (!number1 || !number2 || !number3) {
                alert('請輸入所有數字');
                return;
            }

            const pos1 = calculatePosition(1, number1);
            const pos2 = calculatePosition(pos1, number2);
            const pos3 = calculatePosition(pos2, number3);

            document.querySelectorAll('.cell').forEach(cell => {
                cell.style.backgroundColor = 'white';
            });

            document.getElementById(`cell${pos1}`).style.backgroundColor = 'rgba(255, 0, 0, 0.3)';
            document.getElementById(`cell${pos2}`).style.backgroundColor = 'rgba(0, 255, 0, 0.3)';
            document.getElementById(`cell${pos3}`).style.backgroundColor = 'rgba(0, 0, 255, 0.3)';

            
            const element1 = divinationData.elements[pos1-1];
            const element2 = divinationData.elements[pos2-1];
            const element3 = divinationData.elements[pos3-1];
            const relation1 = getElementRelation(element1, element2);
            const relation2 = getElementRelation(element2, element3);

            document.getElementById('resultNumbers').textContent = `數字：${number1}, ${number2}, ${number3}`;
            document.getElementById('resultElements').textContent = `五行：${element1}${relation1}${element2}${relation2}${element3}`;
            document.getElementById('resultDirections').innerHTML = `方位：${格行}
            --${divinationData.directions[pos1-1]}。${格行}
            --${divinationData.directions[pos2-1]}。${格行}
            --${divinationData.directions[pos3-1]}。`;
            document.getElementById('resultDeities').innerHTML = `用神：${格行}
            --${divinationData.deities[pos1-1]}。${格行}
            --${divinationData.deities[pos2-1]}。${格行}
            --${divinationData.deities[pos3-1]}。`;

            
            
            saveResult();
        }

        /* 記錄結果功能 */
        function saveResult() {
            const question = document.getElementById('question').value;
            const result = {
                question: question,
                numbers: document.getElementById('resultNumbers').textContent,
                elements: document.getElementById('resultElements').textContent,
                directions: document.getElementById('resultDirections').innerHTML,
                deities: document.getElementById('resultDeities').innerHTML
            };
            let history = JSON.parse(localStorage.getItem('divinationHistory')) || [];
            history.unshift(result);
            localStorage.setItem('divinationHistory', JSON.stringify(history));
            displaySavedResults();
        }
        function displaySavedResults() {
            const history = JSON.parse(localStorage.getItem('divinationHistory')) || [];
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = '';
            history.forEach((result, index) => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <strong>${result.question}</strong><br>
                    ${result.numbers}<br>
                    ${result.elements}<br>
                    ${result.directions}<br>
                    ${result.deities}
                    <button class="deleteBtn" data-index="${index}">刪除</button>
                `;
                historyList.appendChild(li);
            });
        }

        function deleteResult(index) {
            let history = JSON.parse(localStorage.getItem('divinationHistory')) || [];
            history.splice(index, 1);
            localStorage.setItem('divinationHistory', JSON.stringify(history));
            displaySavedResults();
        }
        document.addEventListener('DOMContentLoaded', displaySavedResults);
        document.getElementById('historyList').addEventListener('click', function(e) {
            if (e.target.classList.contains('deleteBtn')) {
                deleteResult(e.target.dataset.index);
            }
        });

        /* 分享功能 */
        function getShareContent() {
            const question = document.getElementById('question').value;
            const result = document.querySelector('.result').innerText;
            return `我在\n${decodeURIComponent(location.href)}\n的占卜結果：\n題目：${question}\n${result}`;
        }

        function shareToX() {
            const shareText = encodeURIComponent(getShareContent());
            const shareUrl = `https://twitter.com/intent/tweet?text=${shareText}`;
            window.open(shareUrl, '_blank');
        }

        function shareToWhatsapp() {
            const shareText = encodeURIComponent(getShareContent());
            const shareUrl = `https://wa.me/?text=${shareText}`;
            window.open(shareUrl, '_blank');
        }

        function copyContent() {
            const content = getShareContent();
            navigator.clipboard.writeText(content).then(() => {
                alert('內容已複製到剪貼板');
            }, (err) => {
                console.error('無法複製內容: ', err);
            });
        }

        document.getElementById('divineBtn').addEventListener('click', divine);
        document.getElementById('shareToX').addEventListener('click', shareToX);
        document.getElementById('shareToWhatsapp').addEventListener('click', shareToWhatsapp);
        document.getElementById('copyContent').addEventListener('click', copyContent);

    </script>
    <p id="translate"></p>
    <p class="mokJsApi_copyright">版權</p>

</body>
<script src="https://64071181.github.io/mokJsapi/mokJsApi.js"></script>
<script>mokJsApi_客戶追蹤();</script>
<script src="https://cdn.staticfile.net/translate.js/3.1.7/translate.js"></script>
<script>
    // 翻譯 
    //translate.language.setLocal('chinese_traditional'); //設置本地語種（當前網頁的語種）。如果不設置，默認自動識別當前網頁顯示文字的語種。 可填寫如 'english'、'chinese_simplified' 等，具體參見文檔下方關於此的說明。
    translate.service.use('client.edge'); //設置機器翻譯服務通道，直接客戶端本身，不依賴服務端 。相關說明參考 http://translate.zvo.cn/43086.html
    translate.execute();//進行翻譯 
</script>

</html>